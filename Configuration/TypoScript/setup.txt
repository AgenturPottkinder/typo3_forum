plugin.tx_srfeuserregister_pi1 {
	create {
		overrideValues.tx_extbase_type = Tx_MmForum_Domain_Model_User_FrontendUser
		fields := addToList(tx_extbase_type)
	}
}

config.tx_extbase.objects {
	Tx_MmForum_Service_Mailing_MailingServiceInterface.className = Tx_MmForum_Service_Mailing_PlainMailingService
}

config.tx_extbase.persistence.classes {

	\TYPO3\CMS\Extbase\Domain\Model\FrontendUser.subclasses {
		Tx_MmForum_Domain_Model_User_FrontendUser = Tx_MmForum_Domain_Model_User_FrontendUser
	}
	
	\TYPO3\CMS\Extbase\Domain\Model\FrontendUserGroup.subclasses {
		Tx_MmForum_Domain_Model_User_FrontendUserGroup = Tx_MmForum_Domain_Model_User_FrontendUserGroup
	}

	Tx_MmForum_Domain_Model_User_FrontendUser {
	
		#subclasses {
		#	Tx_MmForum_Domain_Model_User_FrontendUser = Tx_MmForum_Domain_Model_User_FrontendUser
		#}
		
		mapping {
			tableName = fe_users
			recordType = Tx_MmForum_Domain_Model_User_FrontendUser

			columns {
				tx_mmforum_signature.mapOnProperty = signature
				tx_mmforum_post_count.mapOnProperty = postCount
				tx_mmforum_post_count_season.mapOnProperty = postCountSeason
				tx_mmforum_topic_count.mapOnProperty = topicCount
				tx_mmforum_helpful_count.mapOnProperty = helpfulCount
				tx_mmforum_helpful_count_season.mapOnProperty = helpfulCountSeason
				tx_mmforum_question_count.mapOnProperty = questionCount
				tx_mmforum_support_posts.mapOnProperty = supportPosts
				tx_mmforum_facebook.mapOnProperty = facebook
				tx_mmforum_twitter.mapOnProperty = twitter
				tx_mmforum_google.mapOnProperty = google
				tx_mmforum_skype.mapOnProperty = skype
				tx_mmforum_job.mapOnProperty = job
				tx_mmforum_interests.mapOnProperty = interests
				tx_mmforum_working_environment.mapOnProperty = workingEnvironment
				tx_mmforum_topic_favsubscriptions.mapOnProperty = topicFavSubscriptions
				tx_mmforum_topic_subscriptions.mapOnProperty = topicSubscriptions
				tx_mmforum_forum_subscriptions.mapOnProperty = forumSubscriptions
				tx_mmforum_read_topics.mapOnProperty = readTopics
				tx_mmforum_read_forum.mapOnProperty = readForum
				tx_mmforum_use_gravatar.mapOnProperty = useGravatar
				tx_mmforum_contact.mapOnProperty = contact
				tx_mmforum_private_messages.mapOnProperty = privateMessages
				tx_mmforum_rank.mapOnProperty = rank
				tx_mmforum_points.mapOnProperty = points
				date_of_birth.mapOnProperty = dateOfBirth
			}
		}
	}

	Tx_MmForum_Domain_Model_User_FrontendUserGroup {
		
		mapping {
			tableName = fe_groups
			recordType = Tx_MmForum_Domain_Model_User_FrontendUserGroup
			columns {
						tx_mmforum_user_mod.mapOnProperty = userMod
			}
		}
	}

	Tx_MmForum_Domain_Model_User_Userfield_AbstractUserfield {
		mapping {
			tableName = tx_mmforum_domain_model_user_userfield_userfield
			recordType = Tx_MmForum_Domain_Model_User_Userfield_AbstractUserfield
		}

		subclasses {
			Tx_MmForum_Domain_Model_User_Userfield_TyposcriptUserfield = Tx_MmForum_Domain_Model_User_Userfield_TyposcriptUserfield
			Tx_MmForum_Domain_Model_User_Userfield_TextUserfield = Tx_MmForum_Domain_Model_User_Userfield_TextUserfield
		}
	}

	Tx_MmForum_Domain_Model_User_Userfield_TyposcriptUserfield {
		mapping {
			tableName = tx_mmforum_domain_model_user_userfield_userfield
			recordType = Tx_MmForum_Domain_Model_User_Userfield_TyposcriptUserfield
		}

		subclasses {
			Tx_MmForum_Domain_Model_User_Userfield_TextUserfield = Tx_MmForum_Domain_Model_User_Userfield_TextUserfield
		}
	}

	Tx_MmForum_Domain_Model_User_Userfield_TextUserfield {
		mapping {
			tableName = tx_mmforum_domain_model_user_userfield_userfield
			recordType = Tx_MmForum_Domain_Model_User_Userfield_TextUserfield
		}
	}

	Tx_MmForum_Domain_Model_Moderation_AbstractReport {
		mapping {
			tableName = tx_mmforum_domain_model_moderation_report
		}
		subclasses {
			Tx_MmForum_Domain_Model_Moderation_UserReport = Tx_MmForum_Domain_Model_Moderation_UserReport
			Tx_MmForum_Domain_Model_Moderation_PostReport = Tx_MmForum_Domain_Model_Moderation_PostReport
		}
	}

	Tx_MmForum_Domain_Model_Moderation_UserReport {
		mapping {
			tableName = tx_mmforum_domain_model_moderation_report
			recordType = Tx_MmForum_Domain_Model_Moderation_UserReport
		}
	}

	Tx_MmForum_Domain_Model_Moderation_PostReport {
		mapping {
			tableName = tx_mmforum_domain_model_moderation_report
			recordType = Tx_MmForum_Domain_Model_Moderation_PostReport
		}
	}

	Tx_MmForum_Domain_Model_Format_AbstractTextParserElement {
		mapping {
			tableName = tx_mmforum_domain_model_format_textparser
		}

		subclasses {
			Tx_MmForum_Domain_Model_Format_BBCode = Tx_MmForum_Domain_Model_Format_BBCode
			Tx_MmForum_Domain_Model_Format_Smilie = Tx_MmForum_Domain_Model_Format_Smilie
			Tx_MmForum_Domain_Model_Format_SyntaxHighlighting = Tx_MmForum_Domain_Model_Format_SyntaxHighlighting
		}
	}

	Tx_MmForum_Domain_Model_Format_BBCode {
		mapping {
			tableName = tx_mmforum_domain_model_format_textparser
			recordType = Tx_MmForum_Domain_Model_Format_BBCode
		}

		subclasses {
			Tx_MmForum_Domain_Model_Format_QuoteBBCode = Tx_MmForum_Domain_Model_Format_QuoteBBCode
			Tx_MmForum_Domain_Model_Format_ListBBCode = Tx_MmForum_Domain_Model_Format_ListBBCode
		}
	}

	Tx_MmForum_Domain_Model_Format_QuoteBBCode {
		mapping {
			tableName = tx_mmforum_domain_model_format_textparser
			recordType = Tx_MmForum_Domain_Model_Format_QuoteBBCode
		}
	}

	Tx_MmForum_Domain_Model_Format_ListBBCode {
		mapping {
			tableName = tx_mmforum_domain_model_format_textparser
			recordType = Tx_MmForum_Domain_Model_Format_ListBBCode
		}
	}

	Tx_MmForum_Domain_Model_Format_Smilie {
		mapping {
			tableName = tx_mmforum_domain_model_format_textparser
			recordType = Tx_MmForum_Domain_Model_Format_Smilie
		}
	}

	Tx_MmForum_Domain_Model_Format_SyntaxHighlighting {
		mapping {
			tableName = tx_mmforum_domain_model_format_textparser
			recordType = Tx_MmForum_Domain_Model_Format_SyntaxHighlighting
		}
	}

	Tx_MmForum_Domain_Model_Forum_Topic {
		mapping {
			tableName = tx_mmforum_domain_model_forum_topic
			recordType = 0
		}
		subclasses {
			Tx_MmForum_Domain_Model_Forum_ShadowTopic = Tx_MmForum_Domain_Model_Forum_ShadowTopic
		}
	}

	Tx_MmForum_Domain_Model_Forum_ShadowTopic {
		mapping {
			tableName = tx_mmforum_domain_model_forum_topic
			recordType = 1
		}
	}

	Tx_MmForum_Domain_Model_Forum_CriteriaOption {
		mapping {
			tableName = tx_mmforum_domain_model_forum_criteria_options
			recordType = 1
		}
	}

	Tx_MmForum_Domain_Model_User_PrivateMessagesText {
		mapping {
			tableName = tx_mmforum_domain_model_user_privatemessages_text
			recordType = 1
		}
	}
}

plugin.tx_mmforum.settings {
	debug = 1
	debug {
		disableACLs = 0
	}
	images {
		avatar.uploadDir = uploads/tx_srfeuserregister
		# use following definitions to have different Default avatars for male and female
		#avatar.dummyMale = /uploads/path_to_male_avatar.jpg
		#avatar.dummyFemale = /uploads/path_to_female_avatar.jpg
	}
	pids {
		Forum =
		UserShow =
		UserList =
		QuestionList =
		AllQuestions =
	}
	
	user {
		iconClass_online = iconset-14-user-online
		iconClass_offline = iconset-14-user-offline
	}
	
	attachment {
		allowedMimeTypes = image/gif,image/jpeg,image/png,application/pdf,application/xml,text/plain
		allowedSizeInByte = 4096
		#uploadfolder can be found in the Attachment TCA
	}

	forum {
		post {
			helpfulBtn {
				iconClass = iconset-22-helpful
				eID = mm_forum
			}
		}
	}
	ads {
		timeInterval = 30
	}
	topicIcon {
		basepath =
	}
	forumIcon {
		basepath =
	}
	pagebrowser {
		default {
			itemsPerPage = 20
			showResultCount = 1
			insertBelow = 1
			maximumNumberOfLinks = 9
			showFirstLast = 1
            browseBoxWrap = <div class="tx-ttnews-browsebox"><p>|</ul></div>
            showResultsWrap = |</p><ul>
            LinksWrap = |
            browseLinksWrap = |
            activeLinkWrap = <li><strong>|</strong></li>
            disabledLinkWrap = <li>|</li>
            inactiveLinkWrap = <li>|</li>
		}
		topicShow < default
		topicShow {
		    insertAbove = 1
		    itemsPerPage = 10
		}
	}

	forumController.show {
		pagebrowser < plugin.tx_mmforum.settings.pagebrowser.default
	}

	topicController.show {
		pagebrowser < plugin.tx_mmforum.settings.pagebrowser.default
		pagebrowser {
			itemsPerPage = 10
		}

	}

	userController.index {
		pagebrowser < plugin.tx_mmforum.settings.pagebrowser.default
	}

	userController.listPosts {
		pagebrowser < plugin.tx_mmforum.settings.pagebrowser.default
	}

	format {
		dateFormat = d. m. Y
		dateTimeFormat = d. m. Y, H:i
	}
	widgets {
		newestPosts.limit = 6
		questionPosts.limit = 6
		popularPosts.limit = 6
		helpfulUser.limit = 4
		activeUser.limit = 4
		onlinebox {
			limit = 6
			timeInterval = 900
		}
	}
	textParsing {
		enabledServices {
			basic = Tx_MmForum_TextParser_Service_BasicParserService
			#tidy = Tx_MmForum_TextParser_Service_TidyService
			bbCodes = Tx_MmForum_TextParser_Service_BBCodeParserService
			smilies = Tx_MmForum_TextParser_Service_SmilieParserService
			syntax = Tx_MmForum_TextParser_Service_SyntaxHighlightingParserService
			quotes = Tx_MmForum_TextParser_Service_QuoteParserService
			quotes {
				template = EXT:mm_forum/Resources/Private/Partials/Format/Quote.html
			}

			lists = Tx_MmForum_TextParser_Service_ListParserService
		}

		editorPanel {
			panels {
				bbCodes {
					className = Tx_MmForum_TextParser_Panel_BbCodePanel
					title = LLL:LLLEXT:mm_forum/Resources/Private/Language/locallang.xml:Editor_Panel_Formatting
				}
				syntax {
					className = Tx_MmForum_TextParser_Panel_SyntaxHighlightingPanel
					title = LLL:EXT:mm_forum/Resources/Private/Language/locallang.xml:Editor_Panel_SyntaxHighlighting
					iconClassName = tx-mmforum-miu-code
				}
				smilies {
					className = Tx_MmForum_TextParser_Panel_SmiliePanel
					title = LLL:EXT:mm_forum/Resources/Private/Language/locallang.xml:Editor_Panel_Smilies
					iconClassName = tx-mmforum-miu-smilies
				}
			}
		}
	}

	userfields.core_fields {
		username {
			class = Tx_MmForum_Domain_Model_User_Userfield_TextUserfield
			properties {
				name = LLL:EXT:mm_forum/Resources/Private/Language/locallang_user.xml:Username
				mapToUserObject = username
			}
		}
		registered_since {
			class = Tx_MmForum_Domain_Model_User_Userfield_DateUserfield
			properties {
				name = LLL:EXT:mm_forum/Resources/Private/Language/locallang_user.xml:RegisteredSince
				mapToUserObject = crdate
			}
		}
		real_name {
			class = Tx_MmForum_Domain_Model_User_Userfield_TextUserfield
			properties {
				name = LLL:EXT:mm_forum/Resources/Private/Language/locallang_user.xml:RealName
				mapToUserObject = name
			}
		}
	}
}

plugin.tx_mmforum.view {
    widget.Tx_Fluid_ViewHelpers_Widget_PaginateViewHelper.templateRootPath = {$plugin.tx_mmforum.view.templateRootPath}
    templateRootPath = {$plugin.tx_mmforum.view.templateRootPath}
    partialRootPath = {$plugin.tx_mmforum.view.partialRootPath}
    layoutRootPath = {$plugin.tx_mmforum.view.layoutRootPath}
}

plugin.tx_mmforum.renderer.navigation {

	userlink = COA
	userlink {
		stdWrap.wrap = <li class="dropdown"> | </li>

		10 = CASE
		10 {
			key.field = uid
			0 = TEXT
			0.field = username
			0.noTrimWrap = |<a style="padding-top: 4px; padding-bottom: 4px;" href="#"> |</a>|

			default = TEXT
			default.field = username
			default.noTrimWrap = |<a class="dropdown-toggle" data-toggle="dropdown" href="#" style="padding-top: 4px; padding-bottom: 4px;"> | <b class="caret"></b></a>|
		}


		20 = COA
		20 {
			stdWrap.wrap = <ul class="dropdown-menu"> | </ul>
			stdWrap.if.value = 0
			stdWrap.if.isGreaterThan.field = uid

			10 = TEXT
			10.data = LLL:EXT:mm_forum/Resources/Private/Language/locallang.xml:Button_User_Profile
			10.typolink {
				parameter.field = profilePageUid
				additionalParams.field = uid
				additionalParams.wrap = &tx_mmforum_pi1[controller]=User&tx_mmforum_pi1[action]=show&tx_mmforum_pi1[user]=|
				ATagBeforeWrap = 1
				wrap = <i class="tx-mmforum-icon-16-user-profile"></i>
			}
			10.wrap = <li>|</li>

			50 = TEXT
			50.if.value.field = contact_twitter
			50.if.isTrue = 1
			50.value = Twitter
			50.wrap = <li>|</li>
			50.typolink {
				extTarget = _blank
				parameter.field = contact_twitter
				parameter.wrap = http://twitter.com/#!/|
				ATagBeforeWrap = 1
				wrap = <i class="tx-mmforum-icon-16-user-twitter"></i>
			}
		}
	}

}

plugin.tx_mmforum.renderer.icons {

	abstract_icon = COA
	abstract_icon {
		10 = IMG_RESOURCE
		10.file = EXT:mm_forum/Resources/Public/Images/Icons/Forum/BaseIcon.png
		10.stdWrap.wrap = <div class="tx-mmforum-icon" style="background: url(|) no-repeat">

		100 = TEXT
		100.value = </div>
	}

	report < .abstract_icon
	report {
		10.file = EXT:mm_forum/Resources/Public/Images/Icons/Moderation/Report-32.png

		21 = IMG_RESOURCE
		21.file.import.field = statusIcon
		21.stdWrap.wrap = <div class="tx-mmforum-icon-overlay-br" style="background-image: url(|)"></div>
	}
    forum < .abstract_icon
	forum {
		10.file = EXT:mm_forum/Resources/Public/Images/Icons/Forum/BaseIcon.png
		21 = IMG_RESOURCE
		21.file = EXT:mm_forum/Resources/Public/Images/Icons/Forum/OverlayLocked.png
		21.stdWrap.wrap = <div class="tx-mmforum-icon-overlay-bl" style="background-image: url(|)" title="closed"></div>
		21.stdWrap.if.isTrue.field = closed
	}
	forum_new < .forum
	forum_new {
		10.file = EXT:mm_forum/Resources/Public/Images/Icons/Forum/BaseIcon.png

		21 = IMG_RESOURCE
		21.file = EXT:mm_forum/Resources/Public/Images/Icons/Forum/OverlayLocked.png
		21.stdWrap.wrap = <div class="tx-mmforum-icon-overlay-bl" style="background-image: url(|)" title="closed & new"></div>
		21.stdWrap.if.isTrue.field = closed
	}

	topic < .abstract_icon
	topic {
		10.file = EXT:mm_forum/Resources/Public/Images/Icons/Topic/BaseIcon.png

		20 = IMG_RESOURCE
		20.file = EXT:mm_forum/Resources/Public/Images/Icons/Topic/OverlayImportant.png
		20.stdWrap.wrap = <div class="tx-mmforum-icon-overlay-tl" style="background-image: url(|)" title="important"></div>
		20.stdWrap.if.isTrue.field = important

		22 = IMG_RESOURCE
		22.file = EXT:mm_forum/Resources/Public/Images/Icons/Topic/OverlayLocked.png
		22.stdWrap.wrap = <div class="tx-mmforum-icon-overlay-bl" style="background-image: url(|)" title="closed"></div>
		22.stdWrap.if.isTrue.field = closed

		23 = IMG_RESOURCE
		23.file = EXT:mm_forum/Resources/Public/Images/Icons/Topic/OverlaySolved.png
		23.stdWrap.wrap = <div class="tx-mmforum-icon-overlay-br" style="background-image: url(|)" title="solved"></div>
		23.stdWrap.if.isTrue.field = solved

		24 = IMG_RESOURCE
		24.file = EXT:mm_forum/Resources/Public/Images/Icons/Topic/OverlayMoved.png
		24.stdWrap.wrap = <div class="tx-mmforum-icon-overlay-br" style="background-image: url(|)" title="moved"></div>
		24.stdWrap.if.isTrue.field = moved

		25 = IMG_RESOURCE
		25.file = EXT:mm_forum/Resources/Public/Images/Icons/Topic/OverlaySticky.png
		25.stdWrap.wrap = <div class="tx-mmforum-icon-overlay-tr" style="background-image: url(|)" title="sticky"></div>
		25.stdWrap.if.isTrue.field = sticky
	}
	topic_new < .topic
	topic_new  {
		10.file = EXT:mm_forum/Resources/Public/Images/Icons/Topic/BaseIcon.png
	}


}

plugin.tx_mmforum.userfields {
	text.output = TEXT
	text.output {
		current = 1
	}

	date.output = TEXT
	date.output {
		current = 1
		date = d. m. Y
	}

	country.output = CONTENT
	country.output {
		select {
			selectFields = cn_official_name_local
			andWhere.current = 1
			andWhere.wrap = cn_iso_3="|"
			pidInList = 0
		}
		table = static_countries
		renderObj = TEXT
		renderObj.field = cn_official_name_local
	}

	gender.output = CASE
	gender.output {
		0 = TEXT
		0.value = Male
		1 = TEXT
		1.value = Female
		99 = TEXT
		99.value = Hidden
		key.current = 1
	}
}

page.includeCSS {
	mm_forum = EXT:mm_forum/Resources/Public/Stylesheets/mm_forum.css
	bootstrap = EXT:mm_forum/Resources/Public/Bootstrap/css/bootstrap.css
	markitup_bb = EXT:mm_forum/Resources/Public/Javascript/markitup-1.1.14/sets/mm_forum/style.css
}

page.includeJS {
	jquery = https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js
	jquery.external = 1
	bootstrap = EXT:mm_forum/Resources/Public/Bootstrap/js/bootstrap.min.js
	markitup = EXT:mm_forum/Resources/Public/Javascript/markitup-1.1.14/jquery.markitup.js
}

page.includeJSFooter {
	bootstrap = EXT:mm_forum/Resources/Public/Bootstrap/js/bootstrap.min.js
	mmforum = EXT:mm_forum/Resources/Public/Javascript/mm-forum.js
}

module.tx_mmforum.persistence {
	storagePid = {$plugin.tx_mmforum.persistence.storagePid}
}

plugin.tx_mmforum.persistence {
	storagePid = {$plugin.tx_mmforum.persistence.storagePid}
}
